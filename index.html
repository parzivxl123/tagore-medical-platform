<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tagore Medical Robotics Platform</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-100px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-20px);
            }
        }

        @keyframes glow {

            0%,
            100% {
                box-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
            }

            50% {
                box-shadow: 0 0 40px rgba(16, 185, 129, 0.8);
            }
        }

        @keyframes shimmer {
            0% {
                background-position: -1000px 0;
            }

            100% {
                background-position: 1000px 0;
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.8s ease-out;
        }

        .animate-slide-in-left {
            animation: slideInLeft 0.6s ease-out;
        }

        .animate-slide-in-right {
            animation: slideInRight 0.6s ease-out;
        }

        .animate-float {
            animation: float 3s ease-in-out infinite;
        }

        .animate-glow {
            animation: glow 2s ease-in-out infinite;
        }

        .glass-morphism {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .gradient-green {
            background: linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%);
        }

        .hover-lift {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .hover-lift:hover {
            transform: translateY(-12px) scale(1.02);
            box-shadow: 0 25px 50px rgba(16, 185, 129, 0.4);
        }

        .medical-card {
            background: linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%);
            border-left: 5px solid #10b981;
        }

        .chat-user {
            animation: slideInRight 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .chat-ai {
            animation: slideInLeft 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        #three-container {
            width: 100%;
            height: 500px;
            border-radius: 16px;
            overflow: hidden;
        }
    </style>
</head>

<body class="bg-gradient-to-br from-emerald-50 via-green-50 to-teal-50 min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Icons
        const Brain = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z" />
                <path d="M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z" />
            </svg>
        );

        const MessageSquare = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
            </svg>
        );

        const Printer = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="6 9 6 2 18 2 18 9" />
                <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2" />
                <rect x="6" y="14" width="12" height="8" />
            </svg>
        );

        const TestTube = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5s-2.5-1.1-2.5-2.5V2" />
                <path d="M8.5 2h7" />
            </svg>
        );

        const CheckCircle = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                <polyline points="22 4 12 14.01 9 11.01" />
            </svg>
        );

        const XCircle = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10" />
                <line x1="15" y1="9" x2="9" y2="15" />
                <line x1="9" y1="9" x2="15" y2="15" />
            </svg>
        );

        const AlertCircle = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10" />
                <line x1="12" y1="8" x2="12" y2="12" />
                <line x1="12" y1="16" x2="12.01" y2="16" />
            </svg>
        );

        // Three.js 3D Model Component with LARGER scale
        const ThreeModel = ({ specs }) => {
            const containerRef = useRef(null);
            const sceneRef = useRef(null);
            const rendererRef = useRef(null);
            const meshRef = useRef(null);

            useEffect(() => {
                if (!containerRef.current) return;

                const scene = new THREE.Scene();
                scene.background = new THREE.Color(0xf0fdf4);
                sceneRef.current = scene;

                const camera = new THREE.PerspectiveCamera(
                    45,
                    containerRef.current.clientWidth / containerRef.current.clientHeight,
                    0.1,
                    1000
                );
                camera.position.set(0, 0, 180); // Moved camera closer for bigger view

                const renderer = new THREE.WebGLRenderer({ antialias: true });
                renderer.setSize(containerRef.current.clientWidth, containerRef.current.clientHeight);
                containerRef.current.appendChild(renderer.domElement);
                rendererRef.current = renderer;

                const ambientLight = new THREE.AmbientLight(0xffffff, 0.7);
                scene.add(ambientLight);

                const directionalLight1 = new THREE.DirectionalLight(0xffffff, 0.8);
                directionalLight1.position.set(10, 10, 10);
                scene.add(directionalLight1);

                const directionalLight2 = new THREE.DirectionalLight(0xffffff, 0.5);
                directionalLight2.position.set(-10, -10, -10);
                scene.add(directionalLight2);

                const pointLight = new THREE.PointLight(0x10b981, 0.6);
                pointLight.position.set(0, 20, 20);
                scene.add(pointLight);

                createMesh(specs);

                const animate = () => {
                    requestAnimationFrame(animate);
                    if (meshRef.current) {
                        meshRef.current.rotation.x += 0.005;
                        meshRef.current.rotation.y += 0.01;
                    }
                    renderer.render(scene, camera);
                };
                animate();

                const handleResize = () => {
                    if (!containerRef.current) return;
                    camera.aspect = containerRef.current.clientWidth / containerRef.current.clientHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(containerRef.current.clientWidth, containerRef.current.clientHeight);
                };
                window.addEventListener('resize', handleResize);

                return () => {
                    window.removeEventListener('resize', handleResize);
                    if (containerRef.current && renderer.domElement) {
                        containerRef.current.removeChild(renderer.domElement);
                    }
                    renderer.dispose();
                };
            }, []);

            useEffect(() => {
                createMesh(specs);
            }, [specs]);

            const createMesh = (specs) => {
                if (!sceneRef.current) return;

                if (meshRef.current) {
                    sceneRef.current.remove(meshRef.current);
                }

                const materialConfig = {
                    titanium: { color: 0xa8a8a8, metalness: 0.9, roughness: 0.2 },
                    ceramic: { color: 0xf5f5f5, metalness: 0.3, roughness: 0.1 },
                    polymer: { color: 0x8b9cff, metalness: 0.5, roughness: 0.4 }
                };

                const matConfig = materialConfig[specs.material] || materialConfig.titanium;
                const material = new THREE.MeshStandardMaterial(matConfig);

                // BIGGER SCALE - multiplied by 1.5 for better visibility
                const length = (specs.length / 10) * 1.5;
                const width = (specs.width / 10) * 1.5;

                if (specs.type === 'knee') {
                    const group = new THREE.Group();

                    // Upper femoral component
                    const upperGeom = new THREE.CylinderGeometry(width * 0.6, width * 0.7, length * 0.4, 32);
                    const upperMesh = new THREE.Mesh(upperGeom, material);
                    upperMesh.position.y = length * 0.3;
                    group.add(upperMesh);

                    // Middle joint sphere
                    const middleGeom = new THREE.SphereGeometry(width * 0.5, 32, 32);
                    const middleMesh = new THREE.Mesh(middleGeom, material);
                    group.add(middleMesh);

                    // Lower tibial component
                    const lowerGeom = new THREE.CylinderGeometry(width * 0.7, width * 0.6, length * 0.4, 32);
                    const lowerMesh = new THREE.Mesh(lowerGeom, material);
                    lowerMesh.position.y = -length * 0.3;
                    group.add(lowerMesh);

                    meshRef.current = group;
                } else if (specs.type === 'hip') {
                    const group = new THREE.Group();

                    // Socket
                    const socketGeom = new THREE.SphereGeometry(width * 0.6, 32, 32, 0, Math.PI * 2, 0, Math.PI / 2);
                    const socketMesh = new THREE.Mesh(socketGeom, material);
                    socketMesh.position.y = length * 0.3;
                    group.add(socketMesh);

                    // Ball
                    const ballGeom = new THREE.SphereGeometry(width * 0.4, 32, 32);
                    const ballMesh = new THREE.Mesh(ballGeom, material);
                    ballMesh.position.y = length * 0.2;
                    group.add(ballMesh);

                    // Stem
                    const stemGeom = new THREE.CylinderGeometry(width * 0.2, width * 0.3, length * 0.9, 16);
                    const stemMesh = new THREE.Mesh(stemGeom, material);
                    stemMesh.position.y = -length * 0.25;
                    stemMesh.rotation.z = 0.2;
                    group.add(stemMesh);

                    meshRef.current = group;
                } else if (specs.type === 'shoulder') {
                    const group = new THREE.Group();

                    // Humeral head
                    const headGeom = new THREE.SphereGeometry(width * 0.6, 32, 32, 0, Math.PI * 2, 0, Math.PI * 0.6);
                    const headMesh = new THREE.Mesh(headGeom, material);
                    headMesh.position.y = length * 0.3;
                    group.add(headMesh);

                    // Neck
                    const neckGeom = new THREE.CylinderGeometry(width * 0.3, width * 0.35, length * 0.2, 16);
                    const neckMesh = new THREE.Mesh(neckGeom, material);
                    neckMesh.position.y = length * 0.1;
                    group.add(neckMesh);

                    // Stem
                    const stemGeom = new THREE.CylinderGeometry(width * 0.25, width * 0.35, length * 0.8, 16);
                    const stemMesh = new THREE.Mesh(stemGeom, material);
                    stemMesh.position.y = -length * 0.3;
                    group.add(stemMesh);

                    meshRef.current = group;
                } else if (specs.type === 'spinal') {
                    const group = new THREE.Group();

                    // Main vertebral body
                    const bodyGeom = new THREE.BoxGeometry(width * 0.9, length * 0.7, width * 0.9);
                    const bodyMesh = new THREE.Mesh(bodyGeom, material);
                    group.add(bodyMesh);

                    // Pedicle screws (4 corners)
                    for (let i = 0; i < 4; i++) {
                        const screwGeom = new THREE.CylinderGeometry(width * 0.12, width * 0.12, length * 0.5, 8);
                        const screwMesh = new THREE.Mesh(screwGeom, material);
                        const angle = (Math.PI / 2) * i;
                        screwMesh.position.x = Math.cos(angle) * width * 0.6;
                        screwMesh.position.z = Math.sin(angle) * width * 0.6;
                        screwMesh.rotation.z = Math.PI / 2;
                        group.add(screwMesh);
                    }

                    meshRef.current = group;
                }

                sceneRef.current.add(meshRef.current);
            };

            return <div ref={containerRef} id="three-container" className="rounded-2xl shadow-2xl" />;
        };

        const TagoreMedicalPlatform = () => {
            const [currentPage, setCurrentPage] = useState('home');
            const [symptoms, setSymptoms] = useState({
                fever: false, cough: false, chestPain: false, shortnessOfBreath: false,
                fatigue: false, headache: false, nausea: false, abdominalPain: false,
                jointPain: false, rashSkin: false, dizziness: false, soreThroat: false,
                vomiting: false, diarrhea: false, muscleAches: false, chills: false,
                sweating: false, lossOfAppetite: false, weightLoss: false, confusion: false,
                blurredVision: false, backPain: false
            });

            const [patientInfo, setPatientInfo] = useState({
                age: 30, height: 170, weight: 70, comments: ''
            });

            const [vitals, setVitals] = useState({
                temperature: 98.6, heartRate: 72, bloodPressure: '120/80', oxygenSaturation: 98
            });

            // REDUCED LAB TESTS - Only 5 most important ones
            const [labResults, setLabResults] = useState({
                wbcCount: 7000,
                glucose: 90,
                crpLevel: 5,
                hemoglobin: 14.0,
                creatinine: 1.0
            });

            const [diagnosis, setDiagnosis] = useState(null);
            const [chatMessages, setChatMessages] = useState([]);
            const [chatInput, setChatInput] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [prostheticSpecs, setProstheticSpecs] = useState({
    type: 'knee', length: 150, width: 80, material: 'titanium'
});

// Material specifications database
const materialSpecs = {
    titanium: {
        name: 'Medical-Grade Titanium (Ti-6Al-4V)',
        tensileStrength: '880-950 MPa',
        youngsModulus: '110-120 GPa',
        density: '4.43 g/cm³',
        biocompatibility: 'Excellent',
        standards: ['ISO 5832-3', 'ASTM F136', 'FDA Class II'],
        corrosionResistance: 'Superior',
        osseointegration: 'Excellent'
    },
    ceramic: {
        name: 'Bioceramics (Alumina/Zirconia)',
        tensileStrength: '400-500 MPa',
        youngsModulus: '380-400 GPa',
        density: '3.98 g/cm³',
        biocompatibility: 'Excellent',
        standards: ['ISO 6474', 'ASTM F603', 'FDA Class III'],
        corrosionResistance: 'Excellent',
        osseointegration: 'Good'
    },
    polymer: {
        name: 'PEEK Biocompatible Polymer',
        tensileStrength: '90-100 MPa',
        youngsModulus: '3.6-4.0 GPa',
        density: '1.32 g/cm³',
        biocompatibility: 'Very Good',
        standards: ['ISO 10993', 'ASTM F2026', 'FDA Class II'],
        corrosionResistance: 'Good',
        osseointegration: 'Moderate'
    }
};
            const [qaResults, setQaResults] = useState(null);

           const runDiagnosticEngine = () => {
    let conditions = [];
    let urgency = 'LOW';
    let recommendations = [];

    const bmi = (patientInfo.weight / ((patientInfo.height / 100) ** 2)).toFixed(1);
    const symptomCount = Object.values(symptoms).filter(Boolean).length;

    // Urgency based on symptom count
    if (symptomCount > 10) urgency = 'HIGH';
    else if (symptomCount > 5) urgency = 'MEDIUM';

    // CRITICAL - Chest Pain + Cardiac
    if (symptoms.chestPain) {
        if (symptoms.shortnessOfBreath && vitals.heartRate > 100) {
            conditions.push({
                name: 'Acute Coronary Syndrome',
                probability: 88,
                reasoning: 'Chest pain with dyspnea and elevated heart rate suggests cardiac ischemia',
                wiki: 'https://en.wikipedia.org/wiki/Acute_coronary_syndrome'
            });
            urgency = 'CRITICAL';
            recommendations.push('IMMEDIATE: Call 911');
            recommendations.push('Give aspirin 325mg if available');
            recommendations.push('STAT ECG and cardiac troponins');
        } else if (symptoms.sweating && symptoms.nausea) {
            conditions.push({
                name: 'Myocardial Infarction Risk',
                probability: 83,
                reasoning: 'Chest pain with diaphoresis and nausea is classic MI presentation',
                wiki: 'https://en.wikipedia.org/wiki/Myocardial_infarction'
            });
            urgency = 'CRITICAL';
            recommendations.push('IMMEDIATE: Call 911');
            recommendations.push('Chew aspirin 325mg');
            recommendations.push('Emergency cardiac catheterization may be needed');
        } else {
            conditions.push({
                name: 'Angina Pectoris',
                probability: 75,
                reasoning: 'Chest pain requires cardiac evaluation',
                wiki: 'https://en.wikipedia.org/wiki/Angina'
            });
            urgency = urgency === 'LOW' ? 'HIGH' : urgency;
            recommendations.push('URGENT: Emergency department evaluation');
            recommendations.push('12-lead ECG immediately');
            recommendations.push('Cardiac stress test may be needed');
        }
    }

    // RESPIRATORY CONDITIONS
    if (symptoms.fever && symptoms.cough && symptoms.shortnessOfBreath) {
        if (vitals.temperature > 100.4 && vitals.oxygenSaturation < 95) {
            conditions.push({
                name: 'Severe Community-Acquired Pneumonia',
                probability: 87,
                reasoning: 'High fever with cough and hypoxemia indicates severe respiratory infection',
                wiki: 'https://en.wikipedia.org/wiki/Pneumonia'
            });
            urgency = urgency === 'LOW' ? 'HIGH' : urgency;
            recommendations.push('Hospitalization required');
            recommendations.push('Chest X-ray and blood cultures');
            recommendations.push('Broad-spectrum antibiotics (Ceftriaxone + Azithromycin)');
            recommendations.push('Oxygen therapy and respiratory support');
        } else {
            conditions.push({
                name: 'Bronchitis with Lower Respiratory Infection',
                probability: 78,
                reasoning: 'Fever, cough, and breathing difficulty suggest bronchial infection',
                wiki: 'https://en.wikipedia.org/wiki/Bronchitis'
            });
            urgency = 'MEDIUM';
            recommendations.push('Rest and hydration');
            recommendations.push('Chest X-ray to rule out pneumonia');
            recommendations.push('Antibiotics if bacterial (Amoxicillin)');
            recommendations.push('Bronchodilators for breathing relief');
        }
    } else if (symptoms.cough && symptoms.soreThroat && symptoms.fever) {
        conditions.push({
            name: 'Upper Respiratory Tract Infection',
            probability: 82,
            reasoning: 'Fever with cough and sore throat indicates URI',
            wiki: 'https://en.wikipedia.org/wiki/Upper_respiratory_tract_infection'
        });
        recommendations.push('Rest for 7-10 days');
        recommendations.push('Warm salt water gargles');
        recommendations.push('Acetaminophen for fever and pain');
        recommendations.push('Increase fluid intake');
    } else if (symptoms.cough && symptoms.chestPain) {
        conditions.push({
            name: 'Pleurisy',
            probability: 71,
            reasoning: 'Cough with chest pain suggests pleural inflammation',
            wiki: 'https://en.wikipedia.org/wiki/Pleurisy'
        });
        recommendations.push('Chest X-ray to assess pleural space');
        recommendations.push('NSAIDs for pain management');
        recommendations.push('Deep breathing exercises');
        recommendations.push('Follow-up in 1 week');
    }

    // GASTROINTESTINAL CONDITIONS
    if (symptoms.abdominalPain && symptoms.nausea) {
        if (symptoms.fever && labResults.wbcCount > 11000) {
            conditions.push({
                name: 'Acute Appendicitis',
                probability: 82,
                reasoning: 'Abdominal pain + fever + elevated WBC suggests appendicitis',
                wiki: 'https://en.wikipedia.org/wiki/Appendicitis'
            });
            urgency = urgency === 'LOW' ? 'HIGH' : urgency;
            recommendations.push('URGENT: Immediate surgical consultation');
            recommendations.push('Abdominal CT scan with contrast');
            recommendations.push('NPO status (nothing by mouth)');
            recommendations.push('IV antibiotics pre-operatively');
        } else if (symptoms.vomiting && symptoms.diarrhea) {
            conditions.push({
                name: 'Acute Gastroenteritis',
                probability: 79,
                reasoning: 'Nausea, vomiting, and diarrhea indicate GI infection',
                wiki: 'https://en.wikipedia.org/wiki/Gastroenteritis'
            });
            recommendations.push('Oral rehydration solution (Pedialyte/ORS)');
            recommendations.push('BRAT diet (Bananas, Rice, Applesauce, Toast)');
            recommendations.push('Ondansetron for nausea if severe');
            recommendations.push('Monitor for dehydration signs');
        } else {
            conditions.push({
                name: 'Peptic Ulcer Disease',
                probability: 68,
                reasoning: 'Abdominal pain with nausea may indicate gastric ulcer',
                wiki: 'https://en.wikipedia.org/wiki/Peptic_ulcer_disease'
            });
            recommendations.push('Avoid NSAIDs and aspirin');
            recommendations.push('Proton pump inhibitor (Omeprazole 20mg daily)');
            recommendations.push('Upper endoscopy if symptoms persist');
            recommendations.push('H. pylori testing');
        }
    } else if (symptoms.abdominalPain && symptoms.diarrhea) {
        conditions.push({
            name: 'Inflammatory Bowel Disease',
            probability: 66,
            reasoning: 'Persistent abdominal pain with diarrhea suggests IBD',
            wiki: 'https://en.wikipedia.org/wiki/Inflammatory_bowel_disease'
        });
        recommendations.push('Stool sample for culture and calprotectin');
        recommendations.push('Colonoscopy for definitive diagnosis');
        recommendations.push('Anti-inflammatory medications');
        recommendations.push('GI specialist referral');
    }

    // NEUROLOGICAL CONDITIONS
    if (symptoms.headache && symptoms.fever && symptoms.confusion) {
        conditions.push({
            name: 'Meningitis',
            probability: 85,
            reasoning: 'Headache, fever, and altered mental status suggest meningitis',
            wiki: 'https://en.wikipedia.org/wiki/Meningitis'
        });
        urgency = 'CRITICAL';
        recommendations.push('IMMEDIATE: Call 911');
        recommendations.push('Lumbar puncture for CSF analysis');
        recommendations.push('IV antibiotics (Ceftriaxone + Vancomycin)');
        recommendations.push('Isolation precautions');
    } else if (symptoms.headache && symptoms.blurredVision && symptoms.nausea) {
        conditions.push({
            name: 'Migraine with Aura',
            probability: 76,
            reasoning: 'Headache with visual disturbances and nausea indicates migraine',
            wiki: 'https://en.wikipedia.org/wiki/Migraine'
        });
        recommendations.push('Rest in dark, quiet room');
        recommendations.push('Sumatriptan 50-100mg at onset');
        recommendations.push('NSAIDs (Ibuprofen 800mg)');
        recommendations.push('Identify and avoid triggers');
    } else if (symptoms.headache && symptoms.dizziness) {
        conditions.push({
            name: 'Tension-Type Headache with Vertigo',
            probability: 69,
            reasoning: 'Headache with dizziness may indicate tension headache or vestibular issue',
            wiki: 'https://en.wikipedia.org/wiki/Tension_headache'
        });
        recommendations.push('Acetaminophen 500mg every 6 hours');
        recommendations.push('Stress reduction techniques');
        recommendations.push('Physical therapy for neck tension');
        recommendations.push('Vestibular exercises if dizziness persists');
    }

    // MUSCULOSKELETAL CONDITIONS
    if (symptoms.jointPain && symptoms.fever && labResults.crpLevel > 10) {
        conditions.push({
            name: 'Rheumatoid Arthritis Flare',
            probability: 74,
            reasoning: 'Joint pain with fever and elevated CRP suggests inflammatory arthritis',
            wiki: 'https://en.wikipedia.org/wiki/Rheumatoid_arthritis'
        });
        urgency = 'MEDIUM';
        recommendations.push('Rheumatology consultation');
        recommendations.push('RF and anti-CCP antibody testing');
        recommendations.push('NSAIDs or corticosteroids');
        recommendations.push('Joint X-rays for damage assessment');
    } else if (symptoms.jointPain && symptoms.rashSkin) {
        conditions.push({
            name: 'Lupus (Systemic Lupus Erythematosus)',
            probability: 68,
            reasoning: 'Joint pain with rash may indicate autoimmune condition',
            wiki: 'https://en.wikipedia.org/wiki/Systemic_lupus_erythematosus'
        });
        recommendations.push('ANA and anti-dsDNA antibody testing');
        recommendations.push('Rheumatology referral');
        recommendations.push('Sun protection (SPF 50+)');
        recommendations.push('Hydroxychloroquine may be prescribed');
    } else if (symptoms.backPain && symptoms.muscleAches) {
        conditions.push({
            name: 'Lumbar Strain with Myalgia',
            probability: 71,
            reasoning: 'Back pain with muscle aches suggests muscular injury',
            wiki: 'https://en.wikipedia.org/wiki/Back_pain'
        });
        recommendations.push('Rest for 24-48 hours, then gentle activity');
        recommendations.push('Ice first 48 hours, then heat');
        recommendations.push('NSAIDs (Ibuprofen 400mg TID)');
        recommendations.push('Physical therapy exercises');
    }

    // DERMATOLOGICAL CONDITIONS
    if (symptoms.rashSkin && symptoms.fever) {
        conditions.push({
            name: 'Viral Exanthem',
            probability: 73,
            reasoning: 'Rash with fever suggests viral infection',
            wiki: 'https://en.wikipedia.org/wiki/Exanthem'
        });
        recommendations.push('Symptomatic treatment');
        recommendations.push('Antihistamines for itching');
        recommendations.push('Monitor for rash progression');
        recommendations.push('Avoid scratching to prevent infection');
    }

    // METABOLIC/ENDOCRINE CONDITIONS
    if (labResults.glucose > 200 && symptoms.fatigue && symptoms.weightLoss) {
        conditions.push({
            name: 'Diabetes Mellitus (New Onset)',
            probability: 86,
            reasoning: 'High glucose with fatigue and weight loss indicates diabetes',
            wiki: 'https://en.wikipedia.org/wiki/Diabetes_mellitus'
        });
        urgency = urgency === 'LOW' ? 'MEDIUM' : urgency;
        recommendations.push('Immediate HbA1c testing');
        recommendations.push('Endocrinology consultation');
        recommendations.push('Blood glucose monitoring');
        recommendations.push('Dietary counseling and exercise plan');
    } else if (symptoms.fatigue && symptoms.weightLoss && symptoms.fever) {
        conditions.push({
            name: 'Hyperthyroidism',
            probability: 69,
            reasoning: 'Weight loss, fatigue, and possible fever suggest thyroid overactivity',
            wiki: 'https://en.wikipedia.org/wiki/Hyperthyroidism'
        });
        recommendations.push('TSH, Free T4, and Free T3 testing');
        recommendations.push('Thyroid ultrasound');
        recommendations.push('Endocrinology referral');
        recommendations.push('Beta-blockers for symptom management');
    }

    // INFECTIOUS DISEASE - Fever patterns
    if (symptoms.fever && symptoms.chills && symptoms.sweating) {
        if (labResults.wbcCount > 15000) {
            conditions.push({
                name: 'Sepsis',
                probability: 81,
                reasoning: 'Fever with chills, sweating, and very high WBC suggests systemic infection',
                wiki: 'https://en.wikipedia.org/wiki/Sepsis'
            });
            urgency = 'CRITICAL';
            recommendations.push('IMMEDIATE: Emergency department');
            recommendations.push('Blood cultures before antibiotics');
            recommendations.push('Broad-spectrum IV antibiotics');
            recommendations.push('Fluid resuscitation');
        } else {
            conditions.push({
                name: 'Influenza',
                probability: 76,
                reasoning: 'Fever with chills and sweating is classic flu presentation',
                wiki: 'https://en.wikipedia.org/wiki/Influenza'
            });
            recommendations.push('Rest and isolation');
            recommendations.push('Oseltamivir if within 48 hours of onset');
            recommendations.push('Acetaminophen for fever');
            recommendations.push('Increase fluid intake significantly');
        }
    } else if (symptoms.fever && !conditions.length) {
        conditions.push({
            name: 'Viral Syndrome',
            probability: 68,
            reasoning: 'Isolated fever likely represents viral infection',
            wiki: 'https://en.wikipedia.org/wiki/Fever'
        });
        recommendations.push('Monitor temperature every 4-6 hours');
        recommendations.push('Acetaminophen 650mg every 6 hours');
        recommendations.push('Increase fluid intake');
        recommendations.push('Follow-up if fever persists >72 hours');
    }

    // RENAL CONDITIONS
    if (labResults.creatinine > 1.5 && symptoms.fatigue && symptoms.nausea) {
        conditions.push({
            name: 'Acute Kidney Injury',
            probability: 77,
            reasoning: 'Elevated creatinine with systemic symptoms suggests kidney dysfunction',
            wiki: 'https://en.wikipedia.org/wiki/Acute_kidney_injury'
        });
        urgency = urgency === 'LOW' ? 'HIGH' : urgency;
        recommendations.push('Nephrology consultation urgently');
        recommendations.push('BUN, electrolytes, urinalysis');
        recommendations.push('Renal ultrasound');
        recommendations.push('Identify and treat underlying cause');
    }

    // ANEMIA
    if (labResults.hemoglobin < 10 && symptoms.fatigue && symptoms.dizziness) {
        conditions.push({
            name: 'Anemia (Moderate to Severe)',
            probability: 84,
            reasoning: 'Low hemoglobin with fatigue and dizziness confirms anemia',
            wiki: 'https://en.wikipedia.org/wiki/Anemia'
        });
        urgency = 'MEDIUM';
        recommendations.push('Iron studies (ferritin, TIBC, serum iron)');
        recommendations.push('Vitamin B12 and folate levels');
        recommendations.push('Iron supplementation (Ferrous sulfate 325mg daily)');
        recommendations.push('Evaluate for bleeding sources');
    }

    // FATIGUE-RELATED CONDITIONS
    if (symptoms.fatigue && symptoms.lossOfAppetite && !conditions.length) {
        conditions.push({
            name: 'Chronic Fatigue Syndrome',
            probability: 62,
            reasoning: 'Persistent fatigue with appetite loss requires comprehensive evaluation',
            wiki: 'https://en.wikipedia.org/wiki/Chronic_fatigue_syndrome'
        });
        recommendations.push('Complete metabolic panel');
        recommendations.push('Thyroid function tests');
        recommendations.push('Sleep study consideration');
        recommendations.push('Gradual increase in activity levels');
    }

    // GENERAL SYMPTOM CLUSTERS
    if (symptomCount >= 5 && conditions.length === 0) {
        // Create more specific diagnosis based on dominant symptoms
        if (symptoms.fatigue && symptoms.muscleAches && symptoms.headache) {
            conditions.push({
                name: 'Fibromyalgia',
                probability: 64,
                reasoning: 'Multiple pain points with fatigue suggests fibromyalgia',
                wiki: 'https://en.wikipedia.org/wiki/Fibromyalgia'
            });
            recommendations.push('Rheumatology consultation');
            recommendations.push('Low-impact exercise program');
            recommendations.push('Sleep hygiene improvement');
            recommendations.push('Consider gabapentin or duloxetine');
        } else {
            conditions.push({
                name: 'Multi-System Viral Illness',
                probability: 61,
                reasoning: 'Multiple symptoms suggest systemic viral infection',
                wiki: 'https://en.wikipedia.org/wiki/Viral_disease'
            });
            recommendations.push('Comprehensive physical examination');
            recommendations.push('Complete blood count and metabolic panel');
            recommendations.push('Rest and supportive care');
            recommendations.push('Follow-up in 7 days');
        }
    }

    // DEFAULT - No symptoms or minimal findings
    if (conditions.length === 0) {
        if (symptomCount > 0) {
            conditions.push({
                name: 'Minor Constitutional Symptoms',
                probability: 58,
                reasoning: 'Limited symptoms require observation and monitoring',
                wiki: 'https://en.wikipedia.org/wiki/Constitutional_symptom'
            });
            recommendations.push('Symptomatic treatment as needed');
            recommendations.push('Monitor symptom progression');
            recommendations.push('Return if symptoms worsen');
            recommendations.push('Maintain good hydration and rest');
        } else {
            conditions.push({
                name: 'No Significant Findings',
                probability: 50,
                reasoning: 'No symptoms reported - routine health maintenance',
                wiki: 'https://en.wikipedia.org/wiki/Preventive_healthcare'
            });
            recommendations.push('Maintain healthy lifestyle');
            recommendations.push('Regular exercise (150 min/week)');
            recommendations.push('Balanced diet rich in fruits and vegetables');
            recommendations.push('Annual wellness visit');
        }
    }

    conditions.sort((a, b) => b.probability - a.probability);

    setDiagnosis({
        conditions,
        urgency,
        recommendations,
        patientInfo,
        vitals,
        labResults,
        bmi,
        symptomCount,
        timestamp: new Date().toLocaleString()
    });
};


            const sendChatMessage = async () => {
                if (!chatInput.trim()) return;

                const userMessage = { role: 'user', content: chatInput };
                setChatMessages(prev => [...prev, userMessage]);
                setChatInput('');
                setIsLoading(true);

                try {
                    const systemPrompt = `You are MediBot, an advanced medical AI for the Tagore Medical Robotics Platform. Provide professional, empathetic medical guidance.

${diagnosis ? `PATIENT CONTEXT:
- Diagnosis: ${diagnosis.conditions[0].name} (${diagnosis.conditions[0].probability}% confidence)
- Reasoning: ${diagnosis.conditions[0].reasoning}
- Patient: Age ${diagnosis.patientInfo.age}, BMI ${diagnosis.bmi}
- Urgency: ${diagnosis.urgency}
- Symptoms: ${diagnosis.symptomCount} active
- Vitals: Temp ${diagnosis.vitals.temperature}°F, HR ${diagnosis.vitals.heartRate}, SpO2 ${diagnosis.vitals.oxygenSaturation}%

Top Recommendations: ${diagnosis.recommendations.slice(0, 3).join('; ')}` : 'No active diagnosis. Ready to discuss general medical topics.'}

Be conversational, warm, and clear. Explain medical concepts without jargon. Reference the diagnosis when relevant. You are MediBot.`;

                    // Build conversation history for Gemini
                    let conversationText = systemPrompt + '\n\nConversation History:\n';
                    chatMessages.forEach(msg => {
                        conversationText += `${msg.role === 'user' ? 'User' : 'MediBot'}: ${msg.content}\n`;
                    });
                    conversationText += `User: ${chatInput}\n\nMediBot:`;

                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=AIzaSyCNY5qO3H6RoPvSBW22vbDX_jXvmo6C_dE`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{
                                    text: conversationText
                                }]
                            }],
                            generationConfig: {
                                temperature: 0.7,
                                maxOutputTokens: 1000
                            }
                        })
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(`Connection failed. Please try again.`);
                    }

                    const data = await response.json();
                    
                    // Handle different response structures
                    let aiResponse = null;
                    
                    if (data.candidates && data.candidates[0]) {
                        const candidate = data.candidates[0];
                        
                        // Try different response structures
                        if (candidate.content && candidate.content.parts && candidate.content.parts[0]) {
                            aiResponse = candidate.content.parts[0].text;
                        } else if (candidate.output) {
                            aiResponse = candidate.output;
                        } else if (candidate.text) {
                            aiResponse = candidate.text;
                        }
                    }
                    
                    // Fallback: check if there's text directly in the response
                    if (!aiResponse && data.text) {
                        aiResponse = data.text;
                    }
                    
                    if (aiResponse) {
                        setChatMessages(prev => [...prev, {
                            role: 'assistant',
                            content: aiResponse
                        }]);
                    } else {
                        throw new Error('Unable to get response. Please try again.');
                    }
                } catch (err) {
                    let fallbackResponse = 'I\'m having trouble connecting right now. Please try again. ';
                    if (diagnosis) {
                        fallbackResponse += `Based on your diagnosis of ${diagnosis.conditions[0].name}, the key recommendations are: ${diagnosis.recommendations.slice(0, 2).join(', ')}. For urgent concerns, please contact your healthcare provider.`;
                    } else {
                        fallbackResponse += 'For urgent medical concerns, contact your healthcare provider.';
                    }
                    setChatMessages(prev => [...prev, {
                        role: 'assistant',
                        content: fallbackResponse
                    }]);
                }
                setIsLoading(false);
            };
            const runQATests = () => {
                const tests = [];

                if (prostheticSpecs.type === 'knee') {
                    tests.push({
                        name: 'Knee Implant Length Verification',
                        status: prostheticSpecs.length >= 120 && prostheticSpecs.length <= 180 ? 'PASS' : 'FAIL',
                        details: `Length: ${prostheticSpecs.length}mm (Range: 120-180mm)`
                    });
                }

                tests.push({
                    name: 'Material Biocompatibility',
                    status: ['titanium', 'ceramic', 'polymer'].includes(prostheticSpecs.material) ? 'PASS' : 'FAIL',
                    details: `Material: ${prostheticSpecs.material}`
                });

                if (diagnosis) {
                    tests.push({
                        name: 'Diagnostic Confidence',
                        status: diagnosis.conditions[0].probability >= 60 ? 'PASS' : 'WARNING',
                        details: `Confidence: ${diagnosis.conditions[0].probability}%`
                    });
                }

                setQaResults({
                    tests,
                    overallStatus: tests.every(t => t.status === 'PASS') ? 'PASS' : tests.some(t => t.status === 'FAIL') ? 'FAIL' : 'WARNING',
                    timestamp: new Date().toLocaleString()
                });
            };

            // HOME PAGE
            if (currentPage === 'home') {
                return (
                    <div className="min-h-screen flex items-center justify-center p-8">
                        <div className="max-w-6xl w-full">
                            <div className="text-center mb-16 animate-fade-in">
                                <div className="inline-block gradient-green p-6 rounded-full mb-6 animate-float">
                                    <Brain size={80} className="text-white" />
                                </div>
                                <h1 className="text-6xl font-bold text-emerald-900 mb-4 animate-slide-in-left">
                                    Tagore Medical Robotics Platform
                                </h1>
                                <p className="text-2xl text-emerald-700 mb-2 animate-slide-in-right">AI-Powered Medical Ecosystem</p>
                                <p className="text-emerald-600">Gizmo Geeks 2025 - Tagore House</p>
                            </div>

                            <div className="grid md:grid-cols-2 gap-8">
                                {[
                                    { id: 'diagnostic', title: 'Diagnostic Engine', icon: Brain, desc: 'Advanced AI-powered diagnosis with comprehensive symptom analysis', color: 'emerald' },
                                    { id: 'chat', title: 'AI Assistant', icon: MessageSquare, desc: 'Intelligent medical consultation with context-aware responses', color: 'green' },
                                    { id: 'prosthetic', title: '3D Prosthetics', icon: Printer, desc: 'Real-time 3D visualization with precise measurements', color: 'teal' },
                                    { id: 'qa', title: 'QA Testing', icon: TestTube, desc: 'Multi-layer quality assurance verification system', color: 'cyan' }
                                ].map((item, idx) => (
                                    <div
                                        key={item.id}
                                        onClick={() => setCurrentPage(item.id)}
                                        className={`medical-card p-8 rounded-2xl cursor-pointer hover-lift shadow-xl animate-fade-in`}
                                        style={{ animationDelay: `${idx * 0.2}s` }}
                                    >
                                        <div className={`bg-gradient-to-br from-${item.color}-500 to-${item.color}-600 w-16 h-16 rounded-xl flex items-center justify-center mb-4`}>
                                            <item.icon size={32} className="text-white" />
                                        </div>
                                        <h3 className="text-2xl font-bold text-gray-800 mb-2">{item.title}</h3>
                                        <p className="text-gray-600">{item.desc}</p>
                                        <button className="mt-4 text-emerald-600 font-semibold hover:text-emerald-700 transition">
                                            Launch Module →
                                        </button>
                                    </div>
                                ))}
                            </div>

                            <div className="mt-12 text-center text-gray-600">
                                <p className="font-semibold">Team: Aarush Manglunia, Arjun Patel, Arya Phad, Samaara Mohid</p>
                            </div>
                        </div>
                    </div>
                );
            }

            // DIAGNOSTIC PAGE
            if (currentPage === 'diagnostic') {
                return (
                    <div className="min-h-screen p-8">
                        <div className="max-w-7xl mx-auto">
                            <button onClick={() => setCurrentPage('home')} className="mb-6 text-emerald-600 hover:text-emerald-700 font-semibold">
                                ← Back to Home
                            </button>

                            <div className="bg-white rounded-3xl shadow-2xl p-8 animate-fade-in">
                                <h2 className="text-4xl font-bold text-emerald-800 mb-8 flex items-center gap-4">
                                    <Brain size={40} className="text-emerald-600" />
                                    Advanced Diagnostic Engine
                                </h2>

                                <div className="grid md:grid-cols-3 gap-6 mb-8">
                                    <div className="glass-morphism p-6 rounded-2xl hover-lift">
                                        <h3 className="font-bold text-lg mb-4 text-emerald-800">Patient Information</h3>
                                        <div className="space-y-4">
                                            <div>
                                                <label className="text-sm text-gray-700 font-semibold">Age (years)</label>
                                                <input type="number" value={patientInfo.age} onChange={(e) => setPatientInfo({ ...patientInfo, age: Math.max(0, Math.min(150, parseInt(e.target.value) || 0)) })} className="w-full px-4 py-2 border-2 border-emerald-200 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition" min="0" max="150" />
                                            </div>
                                            <div>
                                                <label className="text-sm text-gray-700 font-semibold">Height (cm)</label>
                                                <input type="number" value={patientInfo.height} onChange={(e) => setPatientInfo({ ...patientInfo, height: Math.max(50, Math.min(250, parseInt(e.target.value) || 0)) })} className="w-full px-4 py-2 border-2 border-emerald-200 rounded-xl focus:ring-2 focus:ring-emerald-500 transition" min="50" max="250" />
                                            </div>
                                            <div>
                                                <label className="text-sm text-gray-700 font-semibold">Weight (kg)</label>
                                                <input type="number" value={patientInfo.weight} onChange={(e) => setPatientInfo({ ...patientInfo, weight: Math.max(1, Math.min(500, parseInt(e.target.value) || 0)) })} className="w-full px-4 py-2 border-2 border-emerald-200 rounded-xl focus:ring-2 focus:ring-emerald-500 transition" min="1" max="500" />
                                            </div>
                                            <div className="bg-emerald-50 p-4 rounded-xl border-2 border-emerald-200">
                                                <p className="text-sm font-bold text-emerald-800">BMI: {(patientInfo.weight / ((patientInfo.height / 100) ** 2)).toFixed(1)}</p>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="glass-morphism p-6 rounded-2xl hover-lift">
                                        <h3 className="font-bold text-lg mb-4 text-emerald-800">Vital Signs</h3>
                                        <div className="space-y-4">
                                            <div>
                                                <label className="text-sm text-gray-700 font-semibold">Temperature (°F)</label>
                                                <input type="number" value={vitals.temperature} onChange={(e) => setVitals({ ...vitals, temperature: Math.max(94, Math.min(110, parseFloat(e.target.value) || 98.6)) })} className="w-full px-4 py-2 border-2 border-emerald-200 rounded-xl focus:ring-2 focus:ring-emerald-500 transition" step="0.1" min="94" max="110" />
                                            </div>
                                            <div>
                                                <label className="text-sm text-gray-700 font-semibold">Heart Rate (bpm)</label>
                                                <input type="number" value={vitals.heartRate} onChange={(e) => setVitals({ ...vitals, heartRate: Math.max(30, Math.min(220, parseInt(e.target.value) || 72)) })} className="w-full px-4 py-2 border-2 border-emerald-200 rounded-xl focus:ring-2 focus:ring-emerald-500 transition" min="30" max="220" />
                                            </div>
                                            <div>
                                                <label className="text-sm text-gray-700 font-semibold">Blood Pressure</label>
                                                <input type="text" value={vitals.bloodPressure} onChange={(e) => setVitals({ ...vitals, bloodPressure: e.target.value })} className="w-full px-4 py-2 border-2 border-emerald-200 rounded-xl focus:ring-2 focus:ring-emerald-500 transition" placeholder="120/80" />
                                            </div>
                                            <div>
                                                <label className="text-sm text-gray-700 font-semibold">O2 Saturation (%)</label>
                                                <input type="number" value={vitals.oxygenSaturation} onChange={(e) => setVitals({ ...vitals, oxygenSaturation: Math.max(70, Math.min(100, parseInt(e.target.value) || 98)) })} className="w-full px-4 py-2 border-2 border-emerald-200 rounded-xl focus:ring-2 focus:ring-emerald-500 transition" min="70" max="100" />
                                            </div>
                                        </div>
                                    </div>

                                    <div className="glass-morphism p-6 rounded-2xl hover-lift">
                                        <h3 className="font-bold text-lg mb-4 text-emerald-800">Lab Results (5 Key Tests)</h3>
                                        <div className="space-y-4">
                                            <div>
                                                <label className="text-sm text-gray-700 font-semibold">WBC Count (/μL)</label>
                                                <input type="number" value={labResults.wbcCount} onChange={(e) => setLabResults({ ...labResults, wbcCount: Math.max(1000, Math.min(50000, parseInt(e.target.value) || 7000)) })} className="w-full px-3 py-2 border-2 border-emerald-200 rounded-lg focus:ring-2 focus:ring-emerald-500 transition" />
                                            </div>
                                            <div>
                                                <label className="text-sm text-gray-700 font-semibold">Glucose (mg/dL)</label>
                                                <input type="number" value={labResults.glucose} onChange={(e) => setLabResults({ ...labResults, glucose: Math.max(40, Math.min(600, parseInt(e.target.value) || 90)) })} className="w-full px-3 py-2 border-2 border-emerald-200 rounded-lg focus:ring-2 focus:ring-emerald-500 transition" />
                                            </div>
                                            <div>
                                                <label className="text-sm text-gray-700 font-semibold">CRP (mg/L)</label>
                                                <input type="number" value={labResults.crpLevel} onChange={(e) => setLabResults({ ...labResults, crpLevel: Math.max(0, Math.min(500, parseFloat(e.target.value) || 5)) })} className="w-full px-3 py-2 border-2 border-emerald-200 rounded-lg focus:ring-2 focus:ring-emerald-500 transition" step="0.1" />
                                            </div>
                                            <div>
                                                <label className="text-sm text-gray-700 font-semibold">Hemoglobin (g/dL)</label>
                                                <input type="number" value={labResults.hemoglobin} onChange={(e) => setLabResults({ ...labResults, hemoglobin: Math.max(5, Math.min(20, parseFloat(e.target.value) || 14.0)) })} className="w-full px-3 py-2 border-2 border-emerald-200 rounded-lg focus:ring-2 focus:ring-emerald-500 transition" step="0.1" />
                                            </div>
                                            <div>
                                                <label className="text-sm text-gray-700 font-semibold">Creatinine (mg/dL)</label>
                                                <input type="number" value={labResults.creatinine} onChange={(e) => setLabResults({ ...labResults, creatinine: Math.max(0.3, Math.min(10, parseFloat(e.target.value) || 1.0)) })} className="w-full px-3 py-2 border-2 border-emerald-200 rounded-lg focus:ring-2 focus:ring-emerald-500 transition" step="0.1" />
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div className="glass-morphism p-6 rounded-2xl mb-8 hover-lift">
                                    <h3 className="font-bold text-lg mb-4 text-emerald-800">Patient Symptoms</h3>
                                    <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                                        {Object.keys(symptoms).map(symptom => (
                                            <label key={symptom} className="flex items-center gap-2 cursor-pointer hover:bg-emerald-50 p-3 rounded-xl transition">
                                                <input type="checkbox" checked={symptoms[symptom]} onChange={(e) => setSymptoms({ ...symptoms, [symptom]: e.target.checked })} className="w-5 h-5 text-emerald-600 rounded" />
                                                <span className="text-sm font-medium capitalize">{symptom.replace(/([A-Z])/g, ' $1').trim()}</span>
                                            </label>
                                        ))}
                                    </div>
                                </div>

                                <div className="glass-morphism p-6 rounded-2xl mb-8">
                                    <h3 className="font-bold text-lg mb-4 text-emerald-800">Additional Comments</h3>
                                    <textarea value={patientInfo.comments} onChange={(e) => setPatientInfo({ ...patientInfo, comments: e.target.value })} className="w-full px-4 py-3 border-2 border-emerald-200 rounded-xl h-24 resize-none focus:ring-2 focus:ring-emerald-500 transition" placeholder="Medical history, medications, allergies..." />
                                </div>

                                <button onClick={runDiagnosticEngine} className="w-full gradient-green text-white py-5 rounded-2xl font-bold text-lg hover:shadow-2xl transition-all duration-300 transform hover:scale-105 flex items-center justify-center gap-3 animate-glow">
                                    <Brain size={28} />
                                    Run Comprehensive Diagnostic Analysis
                                </button>

                                {diagnosis && (
                                    <div className="mt-8 glass-morphism p-8 rounded-2xl border-4 border-emerald-300 animate-fade-in">
                                        <div className="flex items-center justify-between mb-6">
                                            <h3 className="text-3xl font-bold text-emerald-900">Diagnostic Results</h3>
                                            <span className={`px-6 py-3 rounded-full font-bold text-lg shadow-xl ${diagnosis.urgency === 'CRITICAL' ? 'bg-red-600 text-white animate-pulse' : diagnosis.urgency === 'HIGH' ? 'bg-orange-500 text-white' : diagnosis.urgency === 'MEDIUM' ? 'bg-yellow-500 text-white' : 'bg-emerald-500 text-white'}`}>
                                                {diagnosis.urgency} URGENCY
                                            </span>
                                        </div>

                                        <div className="bg-gradient-to-r from-emerald-50 to-green-50 p-6 rounded-xl mb-6 border-2 border-emerald-200">
                                            <div className="grid grid-cols-3 gap-4 text-center">
                                                <div>
                                                    <p className="text-3xl font-bold text-emerald-600">{diagnosis.symptomCount}</p>
                                                    <p className="text-sm text-gray-600">Active Symptoms</p>
                                                </div>
                                                <div>
                                                    <p className="text-3xl font-bold text-emerald-600">{diagnosis.conditions.length}</p>
                                                    <p className="text-sm text-gray-600">Diagnoses</p>
                                                </div>
                                                <div>
                                                    <p className="text-3xl font-bold text-emerald-600">{diagnosis.conditions[0].probability}%</p>
                                                    <p className="text-sm text-gray-600">Confidence</p>
                                                </div>
                                            </div>
                                        </div>

                                        <div className="space-y-4 mb-6">
                                            {diagnosis.conditions.map((condition, idx) => (
                                                <div key={idx} className="bg-white p-6 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300">
                                                    <div className="flex justify-between items-start mb-3">
                                                        <div className="flex-1">
                                                            <h5 className="font-bold text-2xl text-emerald-700 mb-2">{condition.name}</h5>
                                                            {condition.wiki && (
                                                                <a href={condition.wiki} target="_blank" rel="noopener noreferrer" className="text-emerald-600 hover:text-emerald-800 text-sm font-semibold">
                                                                    📚 Learn more →
                                                                </a>
                                                            )}
                                                        </div>
                                                        <span className="bg-gradient-to-r from-emerald-100 to-green-100 text-emerald-800 px-5 py-2 rounded-full text-sm font-bold shadow-md ml-4">
                                                            {condition.probability}%
                                                        </span>
                                                    </div>
                                                    <p className="text-gray-600 italic text-lg">{condition.reasoning}</p>
                                                </div>
                                            ))}
                                        </div>

                                        <div className="bg-white p-6 rounded-2xl shadow-lg mb-6">
                                            <h4 className="font-bold text-emerald-800 mb-4 text-xl">Clinical Recommendations:</h4>
                                            <ul className="space-y-3">
                                                {diagnosis.recommendations.map((rec, idx) => (
                                                    <li key={idx} className="flex items-start gap-3">
                                                        <span className="text-emerald-600 font-bold text-xl">•</span>
                                                        <span className="text-gray-700 text-lg">{rec}</span>
                                                    </li>
                                                ))}
                                            </ul>
                                        </div>

                                        <button onClick={() => setCurrentPage('chat')} className="w-full bg-gradient-to-r from-green-600 to-emerald-600 text-white py-4 rounded-2xl font-bold text-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center gap-2">
                                            <MessageSquare size={24} />
                                            Discuss with MediBot AI
                                        </button>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                );
            }

            // CHAT PAGE
            if (currentPage === 'chat') {
                return (
                    <div className="min-h-screen p-8">
                        <div className="max-w-6xl mx-auto">
                            <button onClick={() => setCurrentPage('home')} className="mb-6 text-emerald-600 hover:text-emerald-700 font-semibold">
                                ← Back to Home
                            </button>

                            <div className="bg-white rounded-3xl shadow-2xl p-8 animate-fade-in">
                                <div className="flex items-center justify-between mb-8">
                                    <h2 className="text-4xl font-bold text-emerald-800 flex items-center gap-4">
                                        <MessageSquare size={40} className="text-emerald-600" />
                                        MediBot AI Assistant
                                    </h2>
                                    {diagnosis && (
                                        <span className="bg-emerald-100 text-emerald-800 px-5 py-3 rounded-full font-bold shadow-lg animate-pulse">
                                            🔗 Diagnosis Context Loaded
                                        </span>
                                    )}
                                </div>

                                <div className="glass-morphism rounded-3xl p-6 h-[600px] overflow-y-auto mb-6 shadow-inner">
                                    {chatMessages.length === 0 && (
                                        <div className="text-center text-gray-500 mt-40 animate-fade-in">
                                            <div className="gradient-green p-8 rounded-full inline-block mb-6 animate-float">
                                                <MessageSquare size={64} className="text-white" />
                                            </div>
                                            <p className="text-2xl mb-4 font-semibold text-emerald-800">Ask me anything about medical conditions</p>
                                            {diagnosis && (
                                                <div className="space-y-2">
                                                    <p className="text-lg text-emerald-600">💡 I have context about your diagnosis!</p>
                                                    <p className="text-md text-gray-600">Try asking:</p>
                                                    <div className="flex flex-wrap gap-2 justify-center mt-3">
                                                        <button onClick={() => setChatInput("Explain my diagnosis in simple terms")} className="bg-emerald-50 hover:bg-emerald-100 px-4 py-2 rounded-full text-sm text-emerald-700 transition">
                                                            "Explain my diagnosis"
                                                        </button>
                                                        <button onClick={() => setChatInput("What are the treatment options?")} className="bg-emerald-50 hover:bg-emerald-100 px-4 py-2 rounded-full text-sm text-emerald-700 transition">
                                                            "Treatment options?"
                                                        </button>
                                                        <button onClick={() => setChatInput("Should I be worried?")} className="bg-emerald-50 hover:bg-emerald-100 px-4 py-2 rounded-full text-sm text-emerald-700 transition">
                                                            "Should I be worried?"
                                                        </button>
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                    )}
                                    {chatMessages.map((msg, idx) => (
                                        <div key={idx} className={msg.role === 'user' ? 'chat-user mb-4' : 'chat-ai mb-4'}>
                                            <div className={`p-5 rounded-3xl shadow-xl ${msg.role === 'user' ? 'gradient-green text-white ml-16' : 'bg-white text-gray-800 mr-16 border-4 border-emerald-100'}`}>
                                                <p className="whitespace-pre-wrap leading-relaxed text-lg">{msg.content}</p>
                                            </div>
                                        </div>
                                    ))}
                                    {isLoading && (
                                        <div className="chat-ai mb-4">
                                            <div className="bg-white p-5 rounded-3xl mr-16 shadow-xl border-4 border-emerald-100">
                                                <div className="flex gap-3 items-center">
                                                    <div className="w-4 h-4 bg-emerald-600 rounded-full animate-pulse"></div>
                                                    <div className="w-4 h-4 bg-emerald-600 rounded-full animate-pulse" style={{ animationDelay: '0.2s' }}></div>
                                                    <div className="w-4 h-4 bg-emerald-600 rounded-full animate-pulse" style={{ animationDelay: '0.4s' }}></div>
                                                    <span className="text-gray-600 ml-2">MediBot is thinking...</span>
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                </div>

                                <div className="flex gap-4">
                                    <input type="text" value={chatInput} onChange={(e) => setChatInput(e.target.value)} onKeyPress={(e) => e.key === 'Enter' && !isLoading && sendChatMessage()} placeholder="Ask about conditions, treatments, medications, or your diagnosis..." className="flex-1 px-6 py-5 border-4 border-emerald-200 rounded-2xl focus:ring-4 focus:ring-emerald-500 focus:border-transparent transition-all duration-300 shadow-lg text-lg" disabled={isLoading} />
                                    <button onClick={sendChatMessage} disabled={isLoading} className="gradient-green text-white px-10 py-5 rounded-2xl font-bold text-lg hover:shadow-2xl transition-all duration-300 disabled:opacity-50 transform hover:scale-105">
                                        Send
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            // PROSTHETIC PAGE
            if (currentPage === 'prosthetic') {
                return (
                    <div className="min-h-screen p-8">
                        <div className="max-w-7xl mx-auto">
                            <button onClick={() => setCurrentPage('home')} className="mb-6 text-emerald-600 hover:text-emerald-700 font-semibold">
                                ← Back to Home
                            </button>

                            <div className="bg-white rounded-3xl shadow-2xl p-8 animate-fade-in">
                                <h2 className="text-4xl font-bold text-emerald-800 mb-8 flex items-center gap-4">
                                    <Printer size={40} className="text-emerald-600" />
                                    3D Prosthetics Manufacturing Center
                                </h2>

                                <div className="grid md:grid-cols-2 gap-8">
                                    <div className="glass-morphism p-6 rounded-2xl hover-lift">
                                        <h3 className="font-bold text-lg mb-6 text-emerald-800">Implant Specifications</h3>
                                        <div className="space-y-5">
                                            <div>
                                                <label className="text-sm text-gray-700 font-semibold block mb-2">Implant Type</label>
                                                <select value={prostheticSpecs.type} onChange={(e) => setProstheticSpecs({ ...prostheticSpecs, type: e.target.value })} className="w-full px-4 py-3 border-2 border-emerald-200 rounded-xl focus:ring-2 focus:ring-emerald-500 transition text-lg">
                                                    <option value="knee">Knee Replacement</option>
                                                    <option value="hip">Hip Replacement</option>
                                                    <option value="shoulder">Shoulder Implant</option>
                                                    <option value="spinal">Spinal Implant</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label className="text-sm text-gray-700 font-semibold block mb-2">Length (mm): {prostheticSpecs.length}</label>
                                                <input type="range" value={prostheticSpecs.length} onChange={(e) => setProstheticSpecs({ ...prostheticSpecs, length: parseInt(e.target.value) })} className="w-full" min="50" max="300" />
                                                <div className="flex justify-between text-xs text-gray-500 mt-1">
                                                    <span>50mm</span>
                                                    <span>300mm</span>
                                                </div>
                                            </div>
                                            <div>
                                                <label className="text-sm text-gray-700 font-semibold block mb-2">Width (mm): {prostheticSpecs.width}</label>
                                                <input type="range" value={prostheticSpecs.width} onChange={(e) => setProstheticSpecs({ ...prostheticSpecs, width: parseInt(e.target.value) })} className="w-full" min="20" max="150" />
                                                <div className="flex justify-between text-xs text-gray-500 mt-1">
                                                    <span>20mm</span>
                                                    <span>150mm</span>
                                                </div>
                                            </div>
                                            <div>
                                                <label className="text-sm text-gray-700 font-semibold block mb-2">Material</label>
                                                <select value={prostheticSpecs.material} onChange={(e) => setProstheticSpecs({ ...prostheticSpecs, material: e.target.value })} className="w-full px-4 py-3 border-2 border-emerald-200 rounded-xl focus:ring-2 focus:ring-emerald-500 transition text-lg">
                                                    <option value="titanium">Medical-Grade Titanium</option>
                                                    <option value="ceramic">Bioceramics</option>
                                                    <option value="polymer">Biocompatible Polymer</option>
                                                </select>
                                            </div>
                                           <div className="bg-emerald-50 p-4 rounded-xl border-2 border-emerald-200 space-y-2">
    <p className="text-sm"><strong className="text-emerald-700">Type:</strong> {prostheticSpecs.type.charAt(0).toUpperCase() + prostheticSpecs.type.slice(1)}</p>
    <p className="text-sm"><strong className="text-emerald-700">Dimensions:</strong> {prostheticSpecs.length}mm × {prostheticSpecs.width}mm</p>
    <p className="text-sm"><strong className="text-emerald-700">Material:</strong> {materialSpecs[prostheticSpecs.material].name}</p>
    <p className="text-sm"><strong className="text-emerald-700">Print Time:</strong> {Math.floor(prostheticSpecs.length / 10)} hours</p>
</div>

<div className="mt-4 bg-white p-4 rounded-xl border-2 border-emerald-200 space-y-3">
    <h4 className="font-bold text-emerald-800 text-sm mb-2">Material Properties</h4>
    <div className="grid grid-cols-2 gap-2 text-xs">
        <div>
            <p className="text-gray-600">Tensile Strength</p>
            <p className="font-semibold text-emerald-700">{materialSpecs[prostheticSpecs.material].tensileStrength}</p>
        </div>
        <div>
            <p className="text-gray-600">Young's Modulus</p>
            <p className="font-semibold text-emerald-700">{materialSpecs[prostheticSpecs.material].youngsModulus}</p>
        </div>
        <div>
            <p className="text-gray-600">Density</p>
            <p className="font-semibold text-emerald-700">{materialSpecs[prostheticSpecs.material].density}</p>
        </div>
        <div>
            <p className="text-gray-600">Biocompatibility</p>
            <p className="font-semibold text-emerald-700">{materialSpecs[prostheticSpecs.material].biocompatibility}</p>
        </div>
        <div>
            <p className="text-gray-600">Corrosion Resistance</p>
            <p className="font-semibold text-emerald-700">{materialSpecs[prostheticSpecs.material].corrosionResistance}</p>
        </div>
        <div>
            <p className="text-gray-600">Osseointegration</p>
            <p className="font-semibold text-emerald-700">{materialSpecs[prostheticSpecs.material].osseointegration}</p>
        </div>
    </div>
</div>

<div className="mt-4 bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-xl border-2 border-blue-200">
    <h4 className="font-bold text-blue-800 text-sm mb-2">Regulatory Compliance</h4>
    <div className="flex flex-wrap gap-2">
        {materialSpecs[prostheticSpecs.material].standards.map((standard, idx) => (
            <span key={idx} className="bg-blue-600 text-white px-3 py-1 rounded-full text-xs font-semibold">
                {standard}
            </span>
        ))}
    </div>
    <p className="text-xs text-gray-600 mt-2">✓ FDA Approved • ✓ CE Marked • ✓ ISO Certified</p>
</div>
                                        </div>
                                    </div>

                                    <div className="glass-morphism p-6 rounded-2xl border-4 border-emerald-300">
                                        <h3 className="font-bold text-lg mb-4 text-emerald-800">Real-Time 3D Visualization</h3>
                                        <ThreeModel specs={prostheticSpecs} />
                                        <div className="mt-4 bg-gradient-to-r from-emerald-100 to-green-100 p-4 rounded-xl">
                                            <p className="text-sm text-emerald-800 font-semibold text-center">
                                                🔄 Interactive 3D model • Updates in real-time
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                
                            </div>
                        </div>
                    </div>
                );
            }

            // QA PAGE
            if (currentPage === 'qa') {
                return (
                    <div className="min-h-screen p-8">
                        <div className="max-w-6xl mx-auto">
                            <button onClick={() => setCurrentPage('home')} className="mb-6 text-emerald-600 hover:text-emerald-700 font-semibold">
                                ← Back to Home
                            </button>

                            <div className="bg-white rounded-3xl shadow-2xl p-8 animate-fade-in">
                                <h2 className="text-4xl font-bold text-emerald-800 mb-8 flex items-center gap-4">
                                    <TestTube size={40} className="text-emerald-600" />
                                    Quality Assurance & Validation System
                                </h2>

                                <div className="glass-morphism p-6 rounded-2xl mb-8 border-2 border-emerald-200">
                                    <h3 className="font-bold text-xl text-emerald-800 mb-3">Comprehensive Testing Protocol</h3>
                                    <p className="text-gray-700 text-lg mb-4">
                                        Advanced verification across diagnostic accuracy, prosthetic specifications, and clinical safety.
                                    </p>
                                    <div className="grid md:grid-cols-3 gap-4">
                                        <div className="bg-emerald-50 p-4 rounded-xl">
                                            <p className="font-bold text-emerald-800">Diagnostic Engine</p>
                                            <p className="text-sm text-gray-600">Confidence & urgency validation</p>
                                        </div>
                                        <div className="bg-blue-50 p-4 rounded-xl">
                                            <p className="font-bold text-blue-800">Prosthetic Design</p>
                                            <p className="text-sm text-gray-600">Dimensional & material checks</p>
                                        </div>
                                        <div className="bg-purple-50 p-4 rounded-xl">
                                            <p className="font-bold text-purple-800">Safety Compliance</p>
                                            <p className="text-sm text-gray-600">ISO & FDA standards</p>
                                        </div>
                                    </div>
                                </div>

                                <button onClick={runQATests} className="w-full gradient-green text-white py-5 rounded-2xl font-bold text-lg hover:shadow-2xl transition-all duration-300 transform hover:scale-105 mb-8 animate-glow">
                                    🔬 Execute Complete QA Test Suite
                                </button>

                                {qaResults && (
                                    <div className="space-y-6 animate-fade-in">
                                        <div className={`p-8 rounded-2xl border-4 ${qaResults.overallStatus === 'PASS' ? 'bg-emerald-50 border-emerald-500' : qaResults.overallStatus === 'FAIL' ? 'bg-red-50 border-red-500' : 'bg-yellow-50 border-yellow-500'}`}>
                                            <div className="flex items-center gap-4 mb-4">
                                                {qaResults.overallStatus === 'PASS' ? (
                                                    <CheckCircle size={48} className="text-emerald-600" />
                                                ) : qaResults.overallStatus === 'FAIL' ? (
                                                    <XCircle size={48} className="text-red-600" />
                                                ) : (
                                                    <AlertCircle size={48} className="text-yellow-600" />
                                                )}
                                                <div>
                                                    <h3 className="text-3xl font-bold text-gray-900">
                                                        Overall Status: {qaResults.overallStatus}
                                                    </h3>
                                                    <p className="text-gray-600 text-lg">{qaResults.timestamp}</p>
                                                </div>
                                            </div>
                                        </div>

                                        <div className="space-y-4">
                                            {qaResults.tests.map((test, idx) => (
                                                <div key={idx} className={`p-6 rounded-2xl border-2 ${test.status === 'PASS' ? 'bg-emerald-50 border-emerald-400' : test.status === 'FAIL' ? 'bg-red-50 border-red-400' : 'bg-yellow-50 border-yellow-400'}`}>
                                                    <div className="flex items-start justify-between">
                                                        <div className="flex-1">
                                                            <div className="flex items-center gap-3 mb-2">
                                                                {test.status === 'PASS' ? (
                                                                    <CheckCircle size={24} className="text-emerald-600" />
                                                                ) : test.status === 'FAIL' ? (
                                                                    <XCircle size={24} className="text-red-600" />
                                                                ) : (
                                                                    <AlertCircle size={24} className="text-yellow-600" />
                                                                )}
                                                                <h4 className="font-bold text-lg text-gray-900">{test.name}</h4>
                                                            </div>
                                                            <p className="text-gray-700 ml-9">{test.details}</p>
                                                        </div>
                                                        <span className={`px-5 py-2 rounded-full text-sm font-bold ${test.status === 'PASS' ? 'bg-emerald-600 text-white' : test.status === 'FAIL' ? 'bg-red-600 text-white' : 'bg-yellow-600 text-white'}`}>
                                                            {test.status}
                                                        </span>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>

                                        <div className="glass-morphism p-8 rounded-2xl">
                                            <h4 className="font-bold text-xl text-emerald-800 mb-6">Test Summary</h4>
                                            <div className="grid grid-cols-3 gap-6 text-center">
                                                <div className="bg-emerald-100 p-6 rounded-2xl">
                                                    <p className="text-5xl font-bold text-emerald-600 mb-2">
                                                        {qaResults.tests.filter(t => t.status === 'PASS').length}
                                                    </p>
                                                    <p className="text-gray-700 font-semibold">Passed</p>
                                                </div>
                                                <div className="bg-yellow-100 p-6 rounded-2xl">
                                                    <p className="text-5xl font-bold text-yellow-600 mb-2">
                                                        {qaResults.tests.filter(t => t.status === 'WARNING').length}
                                                    </p>
                                                    <p className="text-gray-700 font-semibold">Warnings</p>
                                                </div>
                                                <div className="bg-red-100 p-6 rounded-2xl">
                                                    <p className="text-5xl font-bold text-red-600 mb-2">
                                                        {qaResults.tests.filter(t => t.status === 'FAIL').length}
                                                    </p>
                                                    <p className="text-gray-700 font-semibold">Failed</p>
                                                </div>
                                            </div>
                                            <div className="mt-6 bg-white p-4 rounded-xl">
                                                <p className="text-sm text-gray-600 text-center">
                                                    Total Tests: <strong>{qaResults.tests.length}</strong> | Pass Rate: <strong>{((qaResults.tests.filter(t => t.status === 'PASS').length / qaResults.tests.length) * 100).toFixed(1)}%</strong>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {!qaResults && (
                                    <div className="text-center py-20 text-gray-500 animate-fade-in">
                                        <div className="gradient-green p-8 rounded-full inline-block mb-6 animate-float">
                                            <TestTube size={64} className="text-white" />
                                        </div>
                                        <p className="text-2xl font-semibold text-emerald-800 mb-4">Ready to Execute Quality Assurance</p>
                                        <p className="text-gray-600">Run the test suite to validate all components</p>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                );
            }
        };

        ReactDOM.render(<TagoreMedicalPlatform />, document.getElementById('root'));
    </script>
</body>

</html>
